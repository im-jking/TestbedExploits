# Help from https://github.com/Ettercap/ettercap/blob/master/share/etter.filter.examples

# make sure this filter will not be used...
# exit();

# Needs:
# -  Check the source and destination of the packet
#    -  If coming from SCADA and going to Server-2, mangle
#    -  If coming from Server-2 and going to SCADA, send reasonable and unconcerning data
#    -  Else, don't sweat it


#Run the filter; target IPs must be manually entered in code
if (ip.proto == TCP) {
    # Packet is coming from SCADA and going to Server-2
    if (ip.src == '192.168.56.105' && ip.dst == '192.168.56.106'){
        msg("Qualifies for mangling.");
        log((DATA.data + 2), "./data.log");
    }
    # Packet is coming from Server-2 and going to SCADA
    if (ip.src == '192.168.56.106' && ip.dst == '192.168.56.105') {
        msg("Qualifies for falsification.");
        # log((DATA.data + 2), "./data.log");
    }
}

# eof

# vim:ts=3:expandtab